[["index.html", "Analysis of Ecological Data with R 1 Welcome 1.1 Target audience 1.2 Aims of this course 1.3 What this course is not 1.4 Course Outline 2022", " Analysis of Ecological Data with R Marvin Ludwig 1 Welcome Figure 1.1: Landscape Ecology with R 1.1 Target audience You want answers to questions (in landscape ecology)! Primarily ecologists but the methods and skills are useful in many fields. No R knowledge is required (or other programming skills) It is helpful if you know what a spreadsheet is Minimum amount of statistic needed (course explains all the necessary stuff) 1.2 Aims of this course Developing ideas, answering questions Defining steps how to solve a problem Translating these steps into R code Learning the R language “on the fly” Data handling. A lot of data handling. I believe a good understanding of data is one of the most important things in science and work. Learn statistics. Use statistics as a tool. developing good scripting and project management habits from the start (makes live so much easier) 1.3 What this course is not statistics as in mathematical equations \\[ \\left( {\\begin{array}{*{20}c} n \\\\ k \\\\ \\end{array}} \\right) = \\frac{{n!}}{{k!\\left( {n - k} \\right)!}} \\] \\[ \\sigma ^2 = \\mu _2 = \\sum {\\left( {x - \\mu _1 } \\right)^2 P\\left( x \\right)} \\] R as in computer science You probably won’t find out anything you didn’t already know about nature 1.4 Course Outline 2022 Table 1.1: Course Outline Date Content 07.04. Organization - Topic Overview - What is R? - What is ecological data? 14.04. R foundations - functions - vectors 21.04. Aasee water monitoring - dataframes - data input - subsetting 28.04. Aasee water monitoring - strings - boxplots - comparisons 05.05. Aasee water monitoring - fish mortality - tidyverse 12.05. Aasee water monitoring - correlations - linear models 19.05. Biodiversity Data - Task and Tutorium (Vertretung) 26.05. —- Feiertag —- 02.06. Besprechung Task and Tutorium 09.06. —- Pfingstferien —- 16.06. —- Feiertag —- 23.06. Biodiversity Data 30.06. Visualizations - ggplot 07.07. Open Topics 14.07. Wrap up "],["ecological-data.html", "2 Ecological data 2.1 Plot surveys 2.2 Time Series 2.3 Species Lists 2.4 Geospatial Data 2.5 Want more?", " 2 Ecological data Take a few minutes to think about what kind of data you know or have used before? what kind of data would be interesting for you? Figure 2.1: Marburg Open Forest, 2019-05-13 Planetscope RGB Ask yourself how you could describe and quantify a landscape like the one in Fig. 2.1. 2.1 Plot surveys plots with ID and surveyed environmental information bread and butter of ecology Table 2.1: Field survery data on a plot level plotID soil_ph soil_temperature forest_type P1 5.5 10 coniferous P2 5.4 11 coniferous P3 6.1 12 deciduous 2.2 Time Series Figure 2.2: Visualization of time series data continuous measurements measurement interval flexible mainly climate, soil, remote sensing Table 2.2: Time series data: Aasee sensor measurements date temperature ph o2 2021-06-01 18.06 8.12 11.06 2021-06-01 18.08 8.10 10.62 2021-06-01 17.93 8.15 11.20 2021-06-01 17.78 8.19 11.92 2021-06-01 17.79 8.13 11.39 2.3 Species Lists mostly plot based monitoring of conservation sites biodiversity assessment Table 2.3: Species Lists: Occurence on a plot species n Digitalis purpurea 4 Galium odoratum 25 Fagus Sylvatica 20 … … What are the differences between the plot based survey example and the species list example? 2.4 Geospatial Data defined by explicit location on the earth surface information attached to coordinates Table 2.4: Geospatial Data: Tree locations tree_id easting northing species_code dbh geom r00430 477422.4 5631970 BUR 0.12 POINT (477422.4 5631970) r01106 477411.7 5631946 BUR 0.68 POINT (477411.7 5631946) b00818 477796.0 5632316 BUR 0.23 POINT (477796 5632316) r00170 477816.9 5632201 EIT 0.59 POINT (477816.9 5632201) r00334 477737.2 5632250 ERS 0.68 POINT (477737.2 5632250) 2.5 Want more? Turner (2014) : Sensing Biodiversity Animal movement data Lab / Field experiments Individuum based information (e.g. traits) Camera Traps Socio-Economic data (also useful for landscape ecology) … References "],["what-is-r.html", "3 What is R? 3.1 R Code 3.2 Why R? 3.3 Rstudio 3.4 TASK: R and Rstudio", " 3 What is R? Script Language Version 1.0 from 2000 (concept dates back to the 1974) Aim: Statistical Analysis Designed for data analysis and “interactive” use Download: r-project.org r-project.org What you see when you start R 3.1 R Code How R code looks like: data &lt;- c(12, 45, 65, 1, 3, 87) mean(data) data &lt;- data + 5 sort(data) How R code looks like with output: data &lt;- c(12, 45, 65, 1, 3, 87) mean(data) ## [1] 35.5 data &lt;- data + 5 sort(data) ## [1] 6 8 17 50 70 92 3.2 Why R? Easy to get into (although it might not feel that way at first) Designed for solving scientific problems Big community - Getting help is really easy. Open-source, active development The R package structure has been the key addition to the software - J. Chambers M. (2020) Expandable with packages provided by other R users Specialized analysis for specific fields Machine Learning Medicine Writing Books … Used in science, industry, healthcare, NGOs, … Slater et al. (2019) : Workflow with R packages 3.3 Rstudio Integrated Development Environment (IDE) Makes R “convenient” to use Text Editor + R Console Project Environments, Package Management, Help Pages, Plot Viewer, File Browser … 3.4 TASK: R and Rstudio Open R studio and get familiar with the interface. Create a new, empty R script. What is the difference between the script editor and the console? Copy the code below into the R script and run it line by line. Try to understand what each line does. a &lt;- 5 b &lt;- 10 a + b p &lt;- a*b v &lt;- c(3,12,6,9,23) v v / b mean(v) # sum(v) 3.4.1 Questions you might have Why does p &lt;- a*b not produce an output? What is c()? Why does # sum(v) not work? Everything that exists in R is an object. Everything that happens in R is a function call. - J. M. Chambers (2016) References "],["the-aasee-dataset.html", "4 The Aasee Dataset 4.1 Solution", " 4 The Aasee Dataset To learn the basics about data types, data handling and the fundamentals of R, we will work with a dataset from the Aasee in Muenster: Inform yourself real quick here about the origin of the dataset. You can download it here: https://github.com/od-ms/aasee-monitoring Here is an excerpt of the data: Table 4.1: First entries of the Aasee monitoring dataset Datum Wassertemperatur pH.Wert Sauerstoffgehalt 2021-05-31 23:57 17.98 8.05 10.53 2021-06-01 00:09 17.66 8.04 9.64 2021-06-01 00:19 18.03 8.12 11.30 2021-06-01 00:27 18.08 8.14 11.32 2021-06-01 00:39 18.06 8.12 11.06 2021-06-01 00:49 18.01 8.10 10.91 2021-06-01 00:59 18.02 8.10 10.96 2021-06-01 01:08 18.06 8.10 10.83 2021-06-01 01:19 18.08 8.10 10.82 2021-06-01 01:29 18.08 8.10 10.62 As a first intermediate goal we want to deal with the following task. We will learn all the necessary skills in R and a bit of statistics in the next lessons, but it is valuable to think about the task / question beforehand! Compare the water temperature of 2021 June 02 and July 21. What does this task actually mean? Reformulate it as a question Outline steps to answer the question 4.1 Solution Click for Answer # load needed packages library(stringr) # data input june = read.csv(&quot;data/2021-06_aasee.csv&quot;) july = read.csv(&quot;data/2021-07_aasee.csv&quot;) # actual processing ---- # get the day information from the Datum string june$day = str_sub(june$Datum, start = 6, end = 10) july$day = str_sub(july$Datum, start = 6, end = 10) # reduce data to the needed days june = june[june$day == &quot;06-02&quot;,] july = july[july$day == &quot;07-21&quot;,] mean(june$Wassertemperatur) ## [1] 19.50693 mean(july$Wassertemperatur) ## [1] 22.09403 # visual comparison aasee = rbind(june, july) boxplot(aasee$Wassertemperatur ~ aasee$day) What are the flaws of this code? If we want a different month or day we have to make changes in the code. As an R beginner, this is not something you should worry about to much - better spend your time to figure out what the R functions do and get the job done. Later on in your R journey this is something you should keep in mind and write more generalized code by writing your own R functions. Side Note: Creating R functions aasee_daily_mean = function(data, day){ data$day = str_sub(data$Datum, start = 6, end = 10) data = data[data$day == day,] result = mean(data$Wassertemperatur) return(result) } july = read.csv(&quot;data/2021-07_aasee.csv&quot;) aasee_daily_mean(july, &quot;07-17&quot;) ## [1] 21.54029 "],["r-foundations.html", "5 R foundations 5.1 Variables 5.2 Values 5.3 Functions 5.4 Vectors 5.5 Subsetting", " 5 R foundations 5.1 Variables assign values to variables either with &lt;- or = variable on the left, assigned value on the right You decide how to name a variable. Use recognizable names! Don’t be lazy. Longer, descriptive names can help immensely. a &lt;- 5 b = 10 a_big_number = 500000 5.2 Values How is data represented in R? Types we need right now: numeric character (string / text) logical # numeric 1 68542 4.5 # character &quot;f&quot; &quot;Hi Mom!&quot; # logical TRUE F # nothing NA # there should be something, but it is missing NULL # truly nothing 5.3 Functions Everything you do in R is a function! Easily identified by function name followed by parenthesis (), e.g. print() for common functions there are shortcuts # Really everything you do in R is a function! `&lt;-`(a, 5) print(a) ## [1] 5 # both functions above have shortcuts: a &lt;- 5 a ## [1] 5 most functions need arguments input, options, parameters to specify what the function should do each function has a help page where you can read about arguments For example, the cos() function computes the cosine of a number. The help page specifies what the function expects as an input. You can access the help page with ?cos() or by searching for the function in the ‘Help’ tab in Rstudio (bottom right panel). # the cos function needs the argument x of type numeric cos(x = 0) ## [1] 1 # it throws an error otherwise cos(x = &quot;3.14&quot;) ## Error in cos(x = &quot;3.14&quot;): non-numeric argument to mathematical function # argument names can be neglected cos(1) ## [1] 0.5403023 5.4 Vectors most important data structure in R building block for more complicated structures created with the function c() think about a container where you can put in multiple things vectors are atomic - each entry has to be from the same value type each element has an index with which it can be accessed Figure 5.1: R vector model c(23, 1, 60, 21, 21) ## [1] 23 1 60 21 21 # vectors are atomic c(23, 1, 60.5, 21, 21) ## [1] 23.0 1.0 60.5 21.0 21.0 # to actually use a vector we have to assign it to a variable vec = c(23, 1, 60, 21, 21) 5.4.1 Vector Maths Figure 5.2: R vector addition most of the functions in R are “vectorised” i.e. functions are applied to all the elements in a vector vec1 = c(23, 1, 60, 21, 21, 5) vec1 + 6 ## [1] 29 7 66 27 27 11 vec2 = c(5, 1000, 5, 1000, 5, 1000) vec1 - vec2 ## [1] 18 -999 55 -979 16 -995 Figure 5.3: R vector multiplication, different length # be careful with vectors of different length! vec3 = c(1, 2, 1) vec1 * vec3 ## [1] 23 2 60 21 42 5 vec4 = c(1, 2, 1, 2) vec1 * vec4 ## [1] 23 2 60 42 21 10 5.4.2 TASK: Vectors and functions The vector below are the temperature values for 2021-06-02 from the Aasee dataset. Copy it into an empty are script. temperature &lt;- c(18.81,18.73,18.92,18.87,18.76,18.79,18.87,18.84,18.89,18.89, 18.93,18.95,18.92,18.97,19.00,18.99,19.00,19.00,18.99,19.00, 18.98,18.97,18.97,18.97,18.97,18.98,18.96,18.94,18.94,18.91, 18.90,18.89,18.87,18.85,18.85,18.84,18.83,18.81,18.81,18.81, 18.81,18.81,18.80,18.79,18.80,18.79,18.79,18.78,18.77,18.78, 18.79,18.79,18.79,18.79,18.79,18.79,18.80,18.79,18.81,18.80, 18.81,18.81,18.82,18.84,18.87,18.89,18.89,18.91,18.96,19.02, 19.11,19.15,18.95,18.92,18.84,18.85,18.96,18.92,18.95,18.95, 18.91,19.00,19.02,19.06,19.05,19.47,19.32,19.05,19.66,19.57, 19.23,19.42,19.36,19.66,19.79,19.81,19.99,21.10,21.94,22.52, 22.81,22.43,22.16,21.55,21.80,21.02,21.85,21.45,22.48,22.73, 22.61,22.83,20.85,20.68,19.76,19.81,19.74,19.58,19.35,19.40, 19.75,19.76,19.85,19.82,19.86,20.08,20.06,19.85,20.04,19.90, 19.96,20.12,19.94,20.20,20.17,20.31,20.17,20.37,20.36,20.13) To get familiar with the R syntax and vectors, do the following tasks: Convert the temperature from Celsius to Fahrenheit. Try out the following functions: length(), range(), seq() Come up with a reasonable questions that someone might have looking at this data. 5.5 Subsetting For many questions it is often required to access only parts of the data. This is one of the most common things you have to deal with in R. 5.5.1 Indexing To access single values of a vector, use square brackets []. # get the third value of the vector temperature[3] ## [1] 18.92 # accessing multiple elements at once temperature[1,2] ## Error in temperature[1, 2]: incorrect number of dimensions temperature[c(1,2)] ## [1] 18.81 18.73 Using the functions above, what is an easy way to access the first 10 elements of the vector? 5.5.2 Logical Operators Figure 5.4: R vector logical operation A more powerful way to subset a vector is by using logical operators. These functions usually return a boolean object (TRUE, FALSE) which can then be used to access certain values. 1 &gt; 2 ## [1] FALSE 1 &lt; 2 ## [1] TRUE 1 == 2 ## [1] FALSE max(temperature) &gt; 22 ## [1] TRUE temperature &gt; 20 ## [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [15] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [29] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [43] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [57] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [71] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE ## [85] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE ## [99] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE ## [113] TRUE TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE ## [127] TRUE FALSE TRUE FALSE FALSE TRUE FALSE TRUE TRUE TRUE TRUE TRUE TRUE TRUE hot = temperature &gt; 20 temperature[hot] ## [1] 21.10 21.94 22.52 22.81 22.43 22.16 21.55 21.80 21.02 21.85 21.45 22.48 22.73 22.61 ## [15] 22.83 20.85 20.68 20.08 20.06 20.04 20.12 20.20 20.17 20.31 20.17 20.37 20.36 20.13 "],["dataframes.html", "6 Dataframes 6.1 CSV Files 6.2 TASK: Subsetting dataframes", " 6 Dataframes From a data science perspective, the most important class of objects is the data frame - J. Chambers M. (2020) Dataframes combine multiple vector in a structured format Intuitive - most people have seen a spreadsheet before Each column is regarded as a vector Each vector can have a different data type Figure 6.1: data.frames are a named list of vectors Create one with data.frame The functions need the column name followed by the vector of values df = data.frame(plotID = seq(3), soil_ph = c(5.5, 5.4, 6.1), soil_temperature = c(10, 11, 12), forest_type = c(&quot;coniferous&quot;, &quot;coniferous&quot;, &quot;deciduous&quot;)) df ## plotID soil_ph soil_temperature forest_type ## 1 1 5.5 10 coniferous ## 2 2 5.4 11 coniferous ## 3 3 6.1 12 deciduous 6.1 CSV Files Dataframes can be loaded from and saved to .csv files. Comma Separated Values Caution: In Germany “,” is used as the decimal point. You often find “;” as the delimiter in csvs. Caution: If you open csv files in Excel, things can get messy Datum,Wassertemperatur,pH-Wert,Sauerstoffgehalt 2021-05-31 23:57,17.98,8.05,10.53 2021-06-01 00:09,17.66,8.04,9.64 2021-06-01 00:19,18.03,8.12,11.30 2021-06-01 00:27,18.08,8.14,11.32 2021-06-01 00:39,18.06,8.12,11.06 2021-06-01 00:49,18.01,8.10,10.91 use the read.csv function make sure the dec and sep parameters of the function are properly set when in doubt look at the help page ?read.csv data = read.csv(file = &quot;data/2021-06_aasee.csv&quot;, dec = &quot;.&quot;, sep = &quot;,&quot;) # show the first few rows of the df head(data) ## Datum Wassertemperatur pH.Wert Sauerstoffgehalt ## 1 2021-05-31 23:57 17.98 8.05 10.53 ## 2 2021-06-01 00:09 17.66 8.04 9.64 ## 3 2021-06-01 00:19 18.03 8.12 11.30 ## 4 2021-06-01 00:27 18.08 8.14 11.32 ## 5 2021-06-01 00:39 18.06 8.12 11.06 ## 6 2021-06-01 00:49 18.01 8.10 10.91 # show the last few rows of the df tail(data) ## Datum Wassertemperatur pH.Wert Sauerstoffgehalt ## 4220 2021-06-30 22:57 23.73 8.78 17.80 ## 4221 2021-06-30 23:09 23.70 8.72 17.66 ## 4222 2021-06-30 23:18 23.68 8.73 17.72 ## 4223 2021-06-30 23:29 23.64 8.81 18.38 ## 4224 2021-06-30 23:39 23.62 8.76 17.93 ## 4225 2021-06-30 23:49 23.63 8.77 17.82 # get a short summary of the structure str(data) ## &#39;data.frame&#39;: 4225 obs. of 4 variables: ## $ Datum : chr &quot;2021-05-31 23:57&quot; &quot;2021-06-01 00:09&quot; &quot;2021-06-01 00:19&quot; &quot;2021-06-01 00:27&quot; ... ## $ Wassertemperatur: num 18 17.7 18 18.1 18.1 ... ## $ pH.Wert : num 8.05 8.04 8.12 8.14 8.12 8.1 8.1 8.1 8.1 8.1 ... ## $ Sauerstoffgehalt: num 10.53 9.64 11.3 11.32 11.06 ... 6.2 TASK: Subsetting dataframes Setup a Rstudio Project. Have at least a scripts and a data directory. Get the Aasee Dataset into R. Try out the following functions: length(), nrow(), ncol(), summary(), colnames() Create a new dataframe that only contains observations where the pH is above 8. Create a new dataframe that contains exactly the first half of the observations. Create a new column that contains a unique identifier for each row. Do we actually need this unique identifier in our case? Hint 1: Think of a data.frame as a two-dimensional vector. Subsetting the data.frame therefore requires also two values: one for the row, one for the column. # row 1, column 2 data[1,2] ## [1] 17.98 # the first row data[1,] ## Datum Wassertemperatur pH.Wert Sauerstoffgehalt ## 1 2021-05-31 23:57 17.98 8.05 10.53 # the first 3 rows, column 3 and 4 data[seq(3), c(3,4)] ## pH.Wert Sauerstoffgehalt ## 1 8.05 10.53 ## 2 8.04 9.64 ## 3 8.12 11.30 Hint 2: Individual columns can also be accessed by their name with the $ operator. # Access by column name data$Wassertemperatur This can also be used to create new columns by choosing a new column name and writing values into it. # Assign the same value to each row data$newcolumn1 = &quot;valid&quot; # Works, because 4225 rows are a multiple of 5. data$newcolumn2 = seq(5) # Won&#39;t work because the vector of length 2 does not fit exactly into 4225. data$newcolumn3 = c(2,4) ## Error in `$&lt;-.data.frame`(`*tmp*`, newcolumn3, value = c(2, 4)): replacement has 2 rows, data has 4225 # Use an existing column for the new values data$t_kelvin = data$Wassertemperatur + 273.15 # Look at what we did head(data) ## Datum Wassertemperatur pH.Wert Sauerstoffgehalt newcolumn1 newcolumn2 t_kelvin ## 1 2021-05-31 23:57 17.98 8.05 10.53 valid 1 291.13 ## 2 2021-06-01 00:09 17.66 8.04 9.64 valid 2 290.81 ## 3 2021-06-01 00:19 18.03 8.12 11.30 valid 3 291.18 ## 4 2021-06-01 00:27 18.08 8.14 11.32 valid 4 291.23 ## 5 2021-06-01 00:39 18.06 8.12 11.06 valid 5 291.21 ## 6 2021-06-01 00:49 18.01 8.10 10.91 valid 1 291.16 References "],["project-setup.html", "7 Project Setup 7.1 R studio Projects", " 7 Project Setup Once you deal with external files (e.g. loading a .csv), saving outputs or reports, you have to deal with a senseful file structure. This is often harder than the actual R code itself. To keep everything easy and consistent within R (at least for this course), I recommend using Rstudio Projects with a standardized directory setup. 7.1 R studio Projects Here is an example from a blog entry at r-bloggers.com A good starting point for project setup Inside a project, you can then use relative paths to files. # Example of absolute path ## Linux &quot;/home/marvin/projects/rcourse/session02/data/file.csv&quot; ## Windows &quot;C:\\Users\\Marvin\\Dokumente\\rcourse\\session02\\data\\file.csv&quot; # If the R project is set up in the &quot;session02&quot; directory we can use relative paths: # relative path to project root data = read.csv(&quot;data/file.csv&quot;) Additional thoughts always keep raw data backups! filepaths: no spaces no dots no weird characters How to name files Windows uses backslash \\, R wants forward slash / you can use the dir.create function to create a new empty directory "],["string-handling.html", "8 String handling 8.1 The stringr package 8.2 Leading Zeros", " 8 String handling Modifying strings (i.e. text) is a very common task but can be a bit tricky if you start out. Here are some functions to try out: create strings from multiple “substrings” with the paste or paste0 function n = 5 paste(&quot;The number five:&quot;, n) ## [1] &quot;The number five: 5&quot; # again functions are vectorized paste(seq(10), &quot;is&quot;, c(&quot;odd&quot;, &quot;even&quot;)) ## [1] &quot;1 is odd&quot; &quot;2 is even&quot; &quot;3 is odd&quot; &quot;4 is even&quot; &quot;5 is odd&quot; &quot;6 is even&quot; ## [7] &quot;7 is odd&quot; &quot;8 is even&quot; &quot;9 is odd&quot; &quot;10 is even&quot; # paste0 defaults to no character for separating the strings paste0(n, &quot;five&quot;, n) ## [1] &quot;5five5&quot; 8.1 The stringr package For advanced string handling we will make our lives easier by using the stringr package. To use functions from a package we have to load it first with the library function. The first time you want to use a package you might have to install it first with install.packages. install.packages(&quot;stringr&quot;) library(stringr) Many packages have so called vignettes which are tutorial style help pages about the package. You can access vignettes via the “Packages” Pane in R studio or with a quick Google search. It is a good idea to go over the vignette when using a new package. s = &quot;Hi Mom!&quot; # you can indicate in your script from which package a function comes from # by using :: stringr::str_length(s) ## [1] 7 str_sub(string = s, start = 1, end = 2) ## [1] &quot;Hi&quot; string_vector = paste(seq(10), &quot;is&quot;, c(&quot;odd&quot;, &quot;even&quot;)) string_vector ## [1] &quot;1 is odd&quot; &quot;2 is even&quot; &quot;3 is odd&quot; &quot;4 is even&quot; &quot;5 is odd&quot; &quot;6 is even&quot; ## [7] &quot;7 is odd&quot; &quot;8 is even&quot; &quot;9 is odd&quot; &quot;10 is even&quot; str_remove(string_vector, pattern = &quot;is &quot;) ## [1] &quot;1 odd&quot; &quot;2 even&quot; &quot;3 odd&quot; &quot;4 even&quot; &quot;5 odd&quot; &quot;6 even&quot; &quot;7 odd&quot; &quot;8 even&quot; ## [9] &quot;9 odd&quot; &quot;10 even&quot; str_replace(string_vector, pattern = &quot; is&quot;, replacement = &quot;:&quot;) ## [1] &quot;1: odd&quot; &quot;2: even&quot; &quot;3: odd&quot; &quot;4: even&quot; &quot;5: odd&quot; &quot;6: even&quot; &quot;7: odd&quot; &quot;8: even&quot; ## [9] &quot;9: odd&quot; &quot;10: even&quot; 8.2 Leading Zeros str_pad one can be quite important to keep you sane. string_vector = paste(seq(15), &quot;is&quot;, c(&quot;odd&quot;, &quot;even&quot;)) string_vector ## [1] &quot;1 is odd&quot; &quot;2 is even&quot; &quot;3 is odd&quot; &quot;4 is even&quot; &quot;5 is odd&quot; &quot;6 is even&quot; ## [7] &quot;7 is odd&quot; &quot;8 is even&quot; &quot;9 is odd&quot; &quot;10 is even&quot; &quot;11 is odd&quot; &quot;12 is even&quot; ## [13] &quot;13 is odd&quot; &quot;14 is even&quot; &quot;15 is odd&quot; string_vector_pad = paste(str_pad(seq(15), width = 2, pad = 0, side = &quot;left&quot;), &quot;is&quot;, c(&quot;odd&quot;, &quot;even&quot;)) string_vector_pad ## [1] &quot;01 is odd&quot; &quot;02 is even&quot; &quot;03 is odd&quot; &quot;04 is even&quot; &quot;05 is odd&quot; &quot;06 is even&quot; ## [7] &quot;07 is odd&quot; &quot;08 is even&quot; &quot;09 is odd&quot; &quot;10 is even&quot; &quot;11 is odd&quot; &quot;12 is even&quot; ## [13] &quot;13 is odd&quot; &quot;14 is even&quot; &quot;15 is odd&quot; "],["casestudy-aasee-fish-mortality.html", "9 Casestudy: Aasee fish mortality 9.1 TASK: Aasee Critical Oxygen Concentrations 9.2 TASK: Oxygen vs. Temperature", " 9 Casestudy: Aasee fish mortality In 2018, more than twenty tons of fish died in the Aasee due to low oxygen concentrations: https://www.uni-muenster.de/news/view.php?cmdid=9768. Based on this event, a reasonable question might be: On how many days does the Aasee reach critical oxygen concentrations (4 mg/l)? 9.1 TASK: Aasee Critical Oxygen Concentrations On how many days of July 2021 did the Aasee reach critical oxygen concentrations (4 mg/l)? Define the necessary steps! Work in your project environment! How could a good visualization of this look like? 9.2 TASK: Oxygen vs. Temperature The oxygen concentration in water is partly based on the water temperature. An idealized relation between Oxygen and Temperature might look like this: https://www.garnelenhaus.de/media/image/2f/30/57/Ricardo-Castellanos-Sauerstoff-Grafik.jpg We want to find out if this holds true for the Aasee. Formulate a hypothesis. Aggregate temperature and oxygen to daily means. Visualize the relation between temperature and oxygen in the Aasee. Interpret this visualization! "],["tidyverse-functions.html", "10 Tidyverse functions 10.1 dplyr", " 10 Tidyverse functions collection of packages library(tidyverse) loads multiple packages consistent syntax and workflows makes code more readable pipe operator %&gt;% can chain functions together tidy data approach rows are observations columns are variables / features https://ajsmit.github.io/Intro_R_Official/figures/tidy_workflow.png 10.1 dplyr Provides functions for dataframe manipulation Can complement or replace base R functions https://biostat2.uni.lu/lectures/img/06/vaudor_dplyr_schema.png aasee = read.csv(&quot;data/2021-06_aasee.csv&quot;) # slice - gives back a slice of data - i.e. the specified rows aasee = slice(aasee, seq(8)) # select - selects columns select(aasee, Wassertemperatur) ## Wassertemperatur ## 1 17.98 ## 2 17.66 ## 3 18.03 ## 4 18.08 ## 5 18.06 ## 6 18.01 ## 7 18.02 ## 8 18.06 # filter - filters rows based on logical operators filter(aasee, Wassertemperatur &lt; 18) ## Datum Wassertemperatur pH.Wert Sauerstoffgehalt ## 1 2021-05-31 23:57 17.98 8.05 10.53 ## 2 2021-06-01 00:09 17.66 8.04 9.64 # mutate - mutates the data.frame by adding columns mutate(aasee, t_kelvin = Wassertemperatur + 273.15) ## Datum Wassertemperatur pH.Wert Sauerstoffgehalt t_kelvin ## 1 2021-05-31 23:57 17.98 8.05 10.53 291.13 ## 2 2021-06-01 00:09 17.66 8.04 9.64 290.81 ## 3 2021-06-01 00:19 18.03 8.12 11.30 291.18 ## 4 2021-06-01 00:27 18.08 8.14 11.32 291.23 ## 5 2021-06-01 00:39 18.06 8.12 11.06 291.21 ## 6 2021-06-01 00:49 18.01 8.10 10.91 291.16 ## 7 2021-06-01 00:59 18.02 8.10 10.96 291.17 ## 8 2021-06-01 01:08 18.06 8.10 10.83 291.21 # summarise - summarises data summarise(aasee, minimum_t = min(Wassertemperatur)) ## minimum_t ## 1 17.66 The functions itself could all be realized with base R functions: # the same in base R # select aasee$Wassertemperatur ## [1] 17.98 17.66 18.03 18.08 18.06 18.01 18.02 18.06 # filter aasee[,aasee$Wassertemperatur &lt; 18] ## Datum Wassertemperatur ## 1 2021-05-31 23:57 17.98 ## 2 2021-06-01 00:09 17.66 ## 3 2021-06-01 00:19 18.03 ## 4 2021-06-01 00:27 18.08 ## 5 2021-06-01 00:39 18.06 ## 6 2021-06-01 00:49 18.01 ## 7 2021-06-01 00:59 18.02 ## 8 2021-06-01 01:08 18.06 # mutate aasee$t_kelvin = aasee$Wassertemperatur + 273.15 # summarise min(aasee$Wassertemperatur) ## [1] 17.66 The strength of dplyr is the possibility to chain functions with %&gt;%. aasee %&gt;% filter(Wassertemperatur &lt; 18) %&gt;% select(pH.Wert) %&gt;% max() ## [1] 8.05 With base R functions this looks messy, because we have to use functions inside functions. max(aasee$pH.Wert[aasee$Wassertemperatur &lt; 18]) ## [1] 8.05 "],["simple-visualizations.html", "11 Simple Visualizations 11.1 Boxplots 11.2 Histograms 11.3 Scatterplots", " 11 Simple Visualizations 11.1 Boxplots distribution of values great for comparisons https://miro.medium.com/max/1400/1*2c21SkzJMf3frPXPAR_gZA.png july = read.csv(&quot;data/2021-07_aasee.csv&quot;) boxplot(july$Wassertemperatur) summary(july$Wassertemperatur) ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 20.91 21.91 22.33 22.45 22.81 25.24 11.2 Histograms distribution of values aggregated to bins multiple ways to adjust bin size hist(july$Wassertemperatur) hist(july$Wassertemperatur, breaks = 20) hist(july$Wassertemperatur, breaks = seq(min(july$Wassertemperatur), max(july$Wassertemperatur)+0.2, 0.1)) 11.3 Scatterplots classic x-y plot relation between two variables plot(july$Wassertemperatur) plot(x = july$Wassertemperatur, y = july$Sauerstoffgehalt) "],["linear-models.html", "12 Linear Models 12.1 Linear Model Summary 12.2 Linear Model Plot", " 12 Linear Models Linear models describe the relation between two variables. In a non-technical description we can think about linear model like: Find a line that is as close as possible to all the points of a scatterplot. For example, we can use a linear model to depict the relation between the amount of samples animals and the number of different species found in a given area. To create a linear model, we need two vectors (here as two columns of a data.frame) with the matching data pairs (Abundance and Species Number). The lm function then need a formula with the vector/column names separated by ~. Think about the ~ like as a function of. So lm(Species ~ Abundance) means: Give me the number of species as a function of species abundance. library(dplyr) bd = read.csv(&quot;data/crop_species.csv&quot;) bd = bd %&gt;% mutate(TotalInd = AraInd + CaraInd + IsoMyrInd, TotalSpec = AraSpec, CaraSpec, IsoMyrSpec) lmod = lm(bd$TotalSpec ~ bd$TotalInd) lmod ## ## Call: ## lm(formula = bd$TotalSpec ~ bd$TotalInd) ## ## Coefficients: ## (Intercept) bd$TotalInd ## 10.71651 0.01749 12.1 Linear Model Summary Calling the model returns the intercept and slope. To get a more useful output use the summary function. In the following we will go over the output of the summary function on linear models. The explanations are mostly taken from this blog entry: https://feliperego.github.io/blog/2015/10/23/Interpreting-Model-Output-In-R summary(lmod) ## ## Call: ## lm(formula = bd$TotalSpec ~ bd$TotalInd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -6.3136 -1.2481 -0.2235 1.1245 5.3046 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 10.716507 0.991039 10.813 1.58e-15 *** ## bd$TotalInd 0.017491 0.003656 4.784 1.22e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2.416 on 58 degrees of freedom ## Multiple R-squared: 0.2829, Adjusted R-squared: 0.2706 ## F-statistic: 22.89 on 1 and 58 DF, p-value: 1.221e-05 12.1.1 Call the function that was used to create the model 12.1.2 Residuals summary statistic of the model error “How far away are the real values from the model?” should follow a normal distribution (e.g. by plotting a histogram) hist(lmod$residuals) 12.1.3 Coefficients 12.1.3.1 Estimate again the slope and intercept we can expect to observed at least 10.7 different species on a plot (if we collect 103 animals) for each additional animal observed, the species count increases by 0.017 12.1.3.2 Std. Error the expected error of the coefficients for each additional animal observed, the species number increases by 0.017 +- 0.0037 12.1.3.3 t value how many standard deviation is the std. error away from zero? far away from zero is better. Reduces the probability that the result is due to chance usually not interpreted 12.1.3.4 Pr(&gt;|t|) probability that the observed value is larger than t small value means that there is a high chance that the relation is not based on chance p values &lt; than 0.05 is the convention that we can neglect the H0 hypothesis (the model actually depicts a relation) 12.1.3.5 Signif. codes a legend for the significance level of the p-value 12.1.3.6 Residuals standard error the average deviation of the real values from the model value degree of freedom: on how many observations is this value based on? 12.1.3.7 Multiple R-squared How much of the variance is explained by the model? Values between 0 and 1 0 means no explanation, 1 means perfect fit Depends on the specific example! 12.1.3.8 F-statistics Is there a relation between the predictor and the response? Is my model better than if all the coefficients are zero? Away from 1 is good! Depend on number of data points. 12.2 Linear Model Plot Plotting the linear model gives you 4 different figures that indicate if the model is statisically valid in the first place, i.e. if the residuals follow a normal distribution and if they are homoscedatic. 12.2.1 Residuals vs. Fitted Is it actually a linear relation? Points randomly scattered around a horizontal line indicates this 12.2.2 Normal Q-Q Are the residuals normally distributed? Points on the 1-1 line indicates this Depicted are the actual residuals vs. a theoretical normal distribution 12.2.3 Scale location Are the residuals homoscedatic? This means that the range of the residuals are more or less equal for the whole data range Equally spread points around the line indicates this 12.2.4 Residuals vs. Levarage Are there outliers in the data that have influence on the model? In this example, if we would leave out point #12, the model outcome would change. plot(lmod) "],["species-data.html", "13 Species data 13.1 TASK: Crops vs. Species 13.2 Solution", " 13 Species data Many studies in landscape ecology deal with species data. Usually, these studies follow a plot based design to compare different environments and ecosystems in terms of abundances or species diversity. To practice everything we’ve learned so far and to go on further we want to have a look at another real world dataset. The species data below was collected by Michael Meyer. To find out more about the original goal of why this data was collected you can have a look at Meyer et al. (2019). While the statistical analysis of this paper is more advanced and not suited for this beginner course, the structure of the data is very easy and also allows the practice of more simple methods. Table 13.1: First entries of species data by Meyer et at. 2019 plotcode Croptype AraInd AraSpec CaraInd CaraSpec IsoMyrInd IsoMyrSpec IsoDipInd IsoDipSpec 1 WW 111 17 191 15 6 2 6 2 4 SM 102 20 149 14 52 2 52 2 5 WW 154 19 96 11 16 4 15 3 10 SM 13 8 80 12 10 1 10 1 12 ZR 125 14 108 18 14 4 13 3 13 WW 107 15 178 18 23 3 23 3 16 WW 81 19 97 12 23 3 23 3 20 WR 132 20 327 12 8 3 7 2 24 KE 66 12 141 13 9 2 9 2 26 WW 100 17 136 17 4 2 4 2 The column names and crop types appear very cryptic at first sight. Here are some explanations: GP = Grain Pea SB = Sugar Beet SM = Silage Maize WR = Winter oilseed Rape WW = Winter Wheat Ara = Araneae Cara = Carabidae IsoDip = Isopoda and Diplopoda IsoMyr = Isopoda and Myriapoda Ind = Number of individual animals Spec = Number of species 13.1 TASK: Crops vs. Species How many different crop types where analysed in the study? How many plots are there for each crop type? Which plot had the most individual animals? (regardless of species) Which plot was the most diverse? What is the average number of Carabidaes on all the plots containing winter wheat? What is the minimum number of species per crop type? Visualize the number of Carabidaes per crop type. Plot the number of Araneae species in relation to the number of individual Araneae. If there are more individual Araneae on a plot, are there also more Araneae species? 13.2 Solution Click for Answer library(dplyr) bd = read.csv(&quot;data/crop_species.csv&quot;) 13.2.1 How many different crop types where analysed in the study? length(unique(bd$Croptype)) ## [1] 5 13.2.2 How many plots are there for each crop type? length(bd$plotcode[bd$Croptype == &quot;KE&quot;]) ## [1] 3 length(bd$plotcode[bd$Croptype == &quot;SM&quot;]) ## [1] 9 length(bd$plotcode[bd$Croptype == &quot;WR&quot;]) ## [1] 6 length(bd$plotcode[bd$Croptype == &quot;WW&quot;]) ## [1] 33 length(bd$plotcode[bd$Croptype == &quot;ZR&quot;]) ## [1] 9 # for all croptypes at once table(bd$Croptype) ## ## KE SM WR WW ZR ## 3 9 6 33 9 # dplyr bd %&gt;% count(Croptype) ## Croptype n ## 1 KE 3 ## 2 SM 9 ## 3 WR 6 ## 4 WW 33 ## 5 ZR 9 13.2.3 Which plot had the most individual animals? (regardless of species) # calculate the total individuals for each plot bd$TotalInd = bd$AraInd + bd$CaraInd + bd$IsoMyrInd # find out on which plotcode the total number is the maximum total number bd$plotcode[bd$TotalInd == max(bd$TotalInd)] ## [1] 30 # dplyr pipeline bd %&gt;% mutate(TotalInd = AraInd + CaraInd + IsoMyrInd) %&gt;% filter(TotalInd == max(TotalInd)) %&gt;% select(plotcode) ## plotcode ## 1 30 13.2.4 Which plot was the most diverse? bd$TotalSpec = bd$AraSpec + bd$CaraSpec + bd$IsoMyrSpec bd$plotcode[bd$TotalSpec == max(bd$TotalSpec)] ## [1] 98 bd %&gt;% mutate(TotalSpec = AraSpec + CaraSpec + IsoMyrSpec) %&gt;% filter(TotalSpec == max(TotalSpec)) %&gt;% select(plotcode, TotalSpec) ## plotcode TotalSpec ## 1 98 41 13.2.5 What is the average number of Carabidaes on all the plots containing winter wheat? mean(bd$CaraInd[bd$Croptype == &quot;WW&quot;]) ## [1] 119.697 bd %&gt;% filter(Croptype == &quot;WW&quot;) %&gt;% summarise(MeanCara = mean(CaraInd)) ## MeanCara ## 1 119.697 bd %&gt;% filter(Croptype == &quot;WW&quot;) %&gt;% pull(CaraInd) %&gt;% mean() ## [1] 119.697 13.2.6 What is the minimum number of species per crop type? # for one crop type min(bd$TotalSpec[bd$Croptype == &quot;WW&quot;]) ## [1] 26 bd %&gt;% group_by(Croptype) %&gt;% summarise(MinSpec = min(TotalSpec)) ## # A tibble: 5 × 2 ## Croptype MinSpec ## &lt;chr&gt; &lt;int&gt; ## 1 KE 27 ## 2 SM 21 ## 3 WR 24 ## 4 WW 26 ## 5 ZR 23 # if we didn&#39;t compute total species before: bd %&gt;% group_by(Croptype) %&gt;% mutate(TotalSpec = AraSpec + CaraSpec + IsoMyrSpec) %&gt;% summarise(MinSpec = min(TotalSpec)) ## # A tibble: 5 × 2 ## Croptype MinSpec ## &lt;chr&gt; &lt;int&gt; ## 1 KE 27 ## 2 SM 21 ## 3 WR 24 ## 4 WW 26 ## 5 ZR 23 13.2.7 Visualize Carabidaes abunadances per crop type. boxplot(bd$CaraInd ~ bd$Croptype) 13.2.8 Plot the number of Araneae species in relation to the number of individual Araneae. plot(bd$AraInd, bd$AraSpec) 13.2.9 If there are more individual Araneae on a plot, are there also more Araneae species? # build a linear model ara_model = lm(bd$AraSpec ~ bd$AraInd) summary(ara_model) ## ## Call: ## lm(formula = bd$AraSpec ~ bd$AraInd) ## ## Residuals: ## Min 1Q Median 3Q Max ## -4.6170 -1.4779 -0.2867 1.3864 7.2698 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 9.95648 1.18793 8.381 1.41e-11 *** ## bd$AraInd 0.04977 0.01084 4.593 2.40e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 2.443 on 58 degrees of freedom ## Multiple R-squared: 0.2667, Adjusted R-squared: 0.2541 ## F-statistic: 21.09 on 1 and 58 DF, p-value: 2.401e-05 plot(AraSpec ~ AraInd, data = bd) abline(ara_model) plot(AraSpec ~ AraInd, data = bd, asp = 1) abline(ara_model) References "],["urban-trees.html", "14 Urban Trees 14.1 Tasks: Urban Tree Diversity 14.2 Solution", " 14 Urban Trees In the open data portal Münster you can find the location and species group of all the trees that are managed by the city. From there, one can also find the district borders. To put into practice what we have learned for far, below are some tasks using both tree and district information. You can download the two datasets from the learnweb (slightly modified for the course). Figure 14.1: Tree positions in Muenster 14.1 Tasks: Urban Tree Diversity Tree Abundances Load the datasets muenster_baume.csv and muenster_bezirke.csv. Which district has the most trees? Modelling Compare the number of trees in a district with its area: Plot this relation. Is a linear model applicable here? Transform both variables into a logarithmic scale (log()). Plot the relation again and compare. Model the relation between district area and number of trees. Is the model valid? Tree species Which districts inhabit “endemic” species? Which district is the most diverse? Calculate the Shannon index for each district. For this we need a community matrix. Each Row is a District, Each Column a Species. Use the diversity() function from the vegan package on the community matrix. Bonus: Geospatial Data Load or install the sf package. Look at the help page for st_as_sf(). Which arguments do you need? Convert the trees from a data.frame to a sf points object. What has changed? Plot the trees. 14.2 Solution Click for Answer 14.2.1 District with the most trees # Load the packages. # Load the datasets. library(tidyverse) trees = read.csv(&quot;data/muenster_trees.csv&quot;) districts = read.csv(&quot;data/muenster_districts.csv&quot;) head(trees) ## species district X Y ## 1 Tilia Uppenberg 404685.2 5759126 ## 2 Tilia Uppenberg 404698.5 5759130 ## 3 Carpinus Uppenberg 404693.0 5759279 ## 4 Carpinus Uppenberg 404692.9 5759289 ## 5 Carpinus Uppenberg 404692.1 5759319 ## 6 Tilia Uppenberg 404685.6 5759520 head(districts) ## id district district_group area ## 1 15 Bahnhof 2 Innenstadtring 363089.2 ## 2 16 Albachten 5 Münster-West 12965147.7 ## 3 17 Angelmodde 8 Münster-Südost 5016879.5 ## 4 18 Kreuz 2 Innenstadtring 1014690.9 ## 5 19 Berg Fidel 9 Münster-Hiltrup 4781065.8 ## 6 20 Düesberg 3 Mitte-Süd 2185161.9 ## Which district has the most trees? district_summary = trees %&gt;% group_by(district) %&gt;% summarise(ntrees = length(district)) district_summary %&gt;% filter(ntrees == max(ntrees)) ## # A tibble: 1 × 2 ## district ntrees ## &lt;chr&gt; &lt;int&gt; ## 1 Nienberge 2407 # or: table(trees$district) ## ## Aaseestadt Aegidii Albachten Amelsbüren Angelmodde ## 1729 268 1349 1314 517 ## Bahnhof Berg Fidel Buddenturm Coerde Dom ## 478 495 285 333 569 ## Düesberg Geist Gelmer-Dyckburg Gievenbeck Gremmendorf-Ost ## 495 947 691 2082 728 ## Gremmendorf-West Hafen Handorf Hansaplatz Herz-Jesu ## 1125 121 685 344 488 ## Hiltrup-Mitte Hiltrup-Ost Hiltrup-West Josef Kinderhaus-Ost ## 836 450 717 567 942 ## Kinderhaus-West Kreuz Martini Mauritz-Mitte Mauritz-Ost ## 1320 1370 249 1042 1033 ## Mauritz-West Mecklenbeck Neutor Nienberge Pluggendorf ## 561 979 356 2407 447 ## Roxel Rumphorst Schlachthof Schloss Schützenhof ## 1851 1060 921 2030 611 ## Sentrup Sprakel Überwasser Uppenberg Wolbeck ## 2181 716 115 952 1008 14.2.2 Modelling # Compare the number of trees in a district with its area. ## We need a data.frame with the information from both csv files (area and ntrees) ## We use a join for that. districts = left_join(districts, district_summary, by = &quot;district&quot;) # Plot this relation # Is a linear model applicable? -&gt; No plot(ntrees ~ area, data = districts) # Log transformations districts$area_l10 = log10(districts$area) districts$ntrees_l10 = log10(districts$ntrees) # After log transformation, a linear model is more feasible plot(districts$area_l10, districts$ntrees_l10) mod = lm(ntrees_l10 ~ area_l10, data = districts) summary(mod) ## ## Call: ## lm(formula = ntrees_l10 ~ area_l10, data = districts) ## ## Residuals: ## Min 1Q Median 3Q Max ## -0.66598 -0.11579 0.03334 0.14787 0.51588 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 1.12174 0.36513 3.072 0.00368 ** ## area_l10 0.27014 0.05668 4.766 2.17e-05 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.2497 on 43 degrees of freedom ## Multiple R-squared: 0.3456, Adjusted R-squared: 0.3304 ## F-statistic: 22.71 on 1 and 43 DF, p-value: 2.172e-05 plot(mod) plot(districts$area_l10, districts$ntrees_l10) abline(mod, col = &quot;blue&quot;) new_area = data.frame(area_l10 = log10(10000000)) new_area$ntrees_l10 = predict(object = mod, newdata = new_area) plot(districts$area_l10, districts$ntrees_l10) abline(mod, col = &quot;blue&quot;) points(new_area$area_l10, new_area$ntrees_l10, col = &quot;red&quot;) new_area$ntrees_l10 ## [1] 3.012693 # invert log10 10^new_area$ntrees_l10 ## [1] 1029.658 14.2.3 Tree diversity # Which districts inhabit &quot;endemic&quot; species? ## Count the unique districts per tree species, ## Where is this == 1? endemic_species = trees %&gt;% group_by(species) %&gt;% summarise(ndistricts = length(unique(district))) %&gt;% filter(ndistricts == 1) trees %&gt;% filter(species %in% endemic_species$species) %&gt;% pull(district) %&gt;% unique() ## [1] &quot;Geist&quot; &quot;Mecklenbeck&quot; &quot;Gievenbeck&quot; &quot;Kreuz&quot; &quot;Bahnhof&quot; ## [6] &quot;Mauritz-West&quot; &quot;Schloss&quot; &quot;Aaseestadt&quot; trees %&gt;% filter(species %in% endemic_species$species) ## species district X Y ## 1 Cladrastris Geist 404869.2 5754909 ## 2 Catalpha Mecklenbeck 403531.2 5754678 ## 3 Catalpha Mecklenbeck 403521.3 5754677 ## 4 Catalpha Mecklenbeck 403541.1 5754679 ## 5 Catalpha Mecklenbeck 403556.1 5754681 ## 6 Mespilus Gievenbeck 401353.9 5758733 ## 7 Sequoiadendron Kreuz 405850.2 5758408 ## 8 Cryptomeria Bahnhof 405953.9 5757263 ## 9 Davidia Kreuz 405724.5 5758508 ## 10 Sambucus Mauritz-West 406870.7 5757471 ## 11 Decaisnea Schloss 404395.1 5758201 ## 12 Pseudotsuga Schloss 404655.8 5757664 ## 13 Viburnum Aaseestadt 403632.5 5755626 ## 14 Abies Aaseestadt 404304.0 5756153 # Shannon Index # install.packages(&quot;vegan&quot;) library(vegan) # Community Matrix ## Rows: districts ## Columns: species cont = table(trees$district, trees$species) vegan::diversity(cont) ## Aaseestadt Aegidii Albachten Amelsbüren Angelmodde ## 2.694738 1.900178 1.521810 1.319029 2.103345 ## Bahnhof Berg Fidel Buddenturm Coerde Dom ## 2.198826 1.842371 1.497039 1.913592 1.329042 ## Düesberg Geist Gelmer-Dyckburg Gievenbeck Gremmendorf-Ost ## 2.266915 2.225178 1.554180 2.128873 2.126013 ## Gremmendorf-West Hafen Handorf Hansaplatz Herz-Jesu ## 1.708149 1.780047 2.170564 2.469955 2.235766 ## Hiltrup-Mitte Hiltrup-Ost Hiltrup-West Josef Kinderhaus-Ost ## 2.335542 2.327677 1.495869 2.348574 2.077545 ## Kinderhaus-West Kreuz Martini Mauritz-Mitte Mauritz-Ost ## 2.177658 2.519458 1.692007 2.207160 2.497341 ## Mauritz-West Mecklenbeck Neutor Nienberge Pluggendorf ## 2.479100 2.253076 1.969991 2.132541 2.758211 ## Roxel Rumphorst Schlachthof Schloss Schützenhof ## 1.522840 2.161561 2.609566 2.401460 2.516116 ## Sentrup Sprakel Überwasser Uppenberg Wolbeck ## 2.310912 1.942009 2.468009 2.247333 1.520262 "],["advanced-visualizations.html", "15 Advanced Visualizations 15.1 The grammar of graphics 15.2 TASK: Publication ready figures", " 15 Advanced Visualizations Es gibt nur eine Breitbandleitung ins Hirn und das sind die Augen. David Krisel In the course, we used three datasets. All of them have different features and difficulties that we need to keep in mind when we want to visualize parts of the data to point out some interesting facts! The Aasee Water Monitoring data has a temporal component and “continuous” measurements. The arthoropode species on crop fields follow the classic plot based design and allows for comparisons between different groups. The trees and districts of Muenster potentially have a spatial component to it but also allow for comparisons of the different species and districts. 15.1 The grammar of graphics Scientific figures and advanced visualization in R are usually done with the ggplot2 package. https://ggplot2.tidyverse.org/ tidyverse package: synergies and integration with e.g. dplyr layer based language that are combined with + differentiated by “static” and “dynamic” parameters many extensions: https://exts.ggplot2.tidyverse.org/gallery/ Gallery for inspiration: https://r-graph-gallery.com/index.html library(ggplot2) library(viridis) # data overview species = read.csv(&quot;data/crop_species.csv&quot;) 15.1.1 Initialze the plot Tell ggplot which data.frame is the basis for the plot. ggplot(data = species) The mapping argument of the ggplot() function handles which columns of the data should be used for which purpose. To specify this, we use the aes() function (aesthetics). Common things that we specify: x y group color fill Here we specify that on the x-axis in our plot represent the AraInd column. As a result we get the proper y-axis, but still no data is shown. For this, we have to specify in which form the data should be depicted. ggplot(data = species, mapping = aes(x = AraInd)) 15.1.2 Geometry types There are many different geometry types build into ggplot2 and even more from additional packages. The functions to create the geometry layers usually start with geom_. The geom functions also have their own arguments you can specify. geom_point geom_line geom_boxplot geom_histogram … ggplot(species, aes(x = AraInd))+ geom_histogram() ggplot(species, aes(x = AraInd))+ geom_histogram(binwidth = 10, fill = &quot;darkgreen&quot;, color = &quot;black&quot;) Different geometry types require more than one aesthetic. E.g. geom_point needs the x and y aesthetics. ggplot(species, aes(x = Croptype, y = AraInd))+ geom_point() 15.1.3 Axis Formats The Axis format depends on the type of variable you want to plot. We have to be aware of what scale type we have. discrete scale for categorical data continuous scale for numeric data limits, ticks, labels … ggplot(species, aes(x = Croptype, y = AraInd))+ geom_point(size = 4, alpha = 0.8, shape = 18)+ scale_x_discrete(labels = c(&quot;KE&quot; = &quot;Grain Pea&quot;, &quot;SM&quot; = &quot;Silage Maize&quot;, &quot;WR&quot; = &quot;Winter Oilseed Rape&quot;, &quot;WW&quot; = &quot;Winter Wheat&quot;, &quot;ZR&quot; = &quot;Sugar Beet&quot;))+ scale_y_continuous(name = &quot;Aranae [n]&quot;, limits = c(0,200)) We can also save the plot to a object to reuse and modify it later. araind_plot = ggplot(species, aes(x = Croptype, y = AraInd))+ geom_point(size = 4, alpha = 0.8, shape = 18)+ scale_x_discrete(labels = c(&quot;KE&quot; = &quot;Grain Pea&quot;, &quot;SM&quot; = &quot;Silage Maize&quot;, &quot;WR&quot; = &quot;Winter Oilseed Rape&quot;, &quot;WW&quot; = &quot;Winter Wheat&quot;, &quot;ZR&quot; = &quot;Sugar Beet&quot;))+ scale_y_continuous(name = &quot;Aranae [n]&quot;, limits = c(0,200)) araind_plot + ggtitle(&quot;Aranae [n] per crop type&quot;) 15.1.4 Color Scales With the color and fill arguments in aes() we specify which columns of the data.frame should be represented as a color scale in the plot. ggplot(species, aes(x = Croptype, y = AraInd, color = AraSpec))+ geom_point(size = 4, alpha = 0.8, shape = 18)+ scale_x_discrete(name = &quot;Crop Type&quot;)+ scale_y_continuous(name = &quot;Aranae [n]&quot;, limits = c(0,200)) We can specify the colors by adding a scale_color_ layer. Just like with the axis, there are discrete and continuous color scales available! ggplot(species, aes(x = Croptype, y = AraInd, color = AraSpec))+ geom_point(size = 4, alpha = 0.8, shape = 18)+ scale_color_gradient(name = &quot;Aranae\\nSpecies [n]&quot;, low = &quot;yellow&quot;, high = &quot;red&quot;)+ scale_x_discrete(name = &quot;Crop Type&quot;)+ scale_y_continuous(name = &quot;Aranae [n]&quot;, limits = c(0,200)) 15.1.5 Themes There are many prebuild themes… ggplot(species, aes(x = Croptype, y = AraInd, color = AraSpec))+ geom_point(size = 4, alpha = 0.8, shape = 18)+ scale_color_gradientn(name = &quot;Aranae\\nSpecies [n]&quot;,colors = mako(50))+ scale_x_discrete(name = &quot;Crop Type&quot;)+ scale_y_continuous(name = &quot;Aranae [n]&quot;, limits = c(0,200))+ theme_minimal() … or you can specify your own: ggplot(species, aes(x = Croptype, y = AraInd, color = AraSpec))+ geom_point(size = 4, alpha = 0.8, shape = 18)+ scale_color_gradientn(name = &quot;Aranae\\nSpecies [n]&quot;,colors = mako(50))+ scale_x_discrete(name = &quot;Crop Type&quot;)+ scale_y_continuous(name = &quot;Aranae [n]&quot;, limits = c(0,200), expand = c(0,0))+ theme(panel.background = element_blank(), panel.grid.major.y = element_line(color = &quot;black&quot;, linetype = &quot;dotted&quot;), axis.line = element_line(color = &quot;black&quot;)) 15.2 TASK: Publication ready figures Create the following plots: Boxplots of the Aranae Species per crop type. Plot the Carabidae Individuums vs. the Carabidae Species and color the points based on the crop on the field. Create a map of the trees in Münster (with ggplot only!). Create a “heatmap” of the trees in Münster (geom_bin_2d or geom_hex) A bar plot (geom_col) of the Top 10 districts of Münster with the most trees. A time series of the oxygen content in the Aasee with Hint: Use lubridate::ymd_hm() to convert the date into a useful format. 3.1 a horizontal line indicating critical oxygen concentrations of 4 mg/l 3.2 color the line based on the temperature values. Use an appropriate color scale. "],["additional-ressources.html", "16 Additional Ressources 16.1 R cheat sheets 16.2 Useful Keyboard shortcuts", " 16 Additional Ressources 16.1 R cheat sheets These are compact overview of R functions and how to use them. https://www.rstudio.com/resources/cheatsheets/ Useful for the course are the following: Base R stringr lubridate dplyr ggplot2 16.2 Useful Keyboard shortcuts Ctrl + i: indent automatically Ctrl + shift + c: comment / uncomment marked lines Ctrl + s: save script Ctrl + shift + m: insert pipe operator %&gt;% F1: open help page of marked function F2: open source code of marked function "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
